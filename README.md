# Create-Shared-Parameters-CSharp

This study presents a new framework to implement probabilistic methods in the field of performance-driven building design decision-making, using Building Information Modeling (BIM) and parametric tools. Fig. 1 presents the workflow including the key steps of this process, data being transferred, variables, and the software:

![Picture11](https://user-images.githubusercontent.com/44682432/121601208-40782a00-ca0b-11eb-9bdf-6084e003ba89.png)
 
Fig. 1. BIMProbE workflow for probabilistic performance-based design decision-making.
This framework considers the uncertainties in building energy simulations including material properties, internal heat gains, and infiltration and ventilation rates (more details about this framework are presented in [27]). This framework targets the Revit-based building design process and has three main steps described below: 
Pre-processing
The building geometry is modeled in a BIM authoring tool such as Revit. An external application named BIMProbE is developed to set the probability distributions for thermal properties of building materials based on the real-world material properties learned from literature studies and retrieved from an external database (Microsoft Excel). The mapping between the BIM model and the Excel-based database is performed through BIM API and using object-oriented programming. 
Building elements consist of exterior walls, interior walls, roofs, floors, and windows. This program will find and collect opaque components including walls, roofs, and floors. The material IDs associated with each material is identified to collect the thermal properties. The thermal properties of building materials including thickness, thermal conductivity, and R-value can be collected from the BIM model. For instance, the thickness can be accessed as the width of each layer of the building components. As an example, a Structurally Insulated Panel (SIP) wall type consists of six layers of Plasterboard, Wood, Timber Insulated Panel – OSB, Timber Insulated Panel – Insulation, Timber Insulated Panel – OSB, and Sand/Cement Screed. The width of each layer of an SIP wall can be identified as the thickness of that specific material. If the thermal properties of a material are missing in the Revit model, the program will create a thermal asset for that material and will set the thermal properties according to the corresponding values in the Excel database. 
BIMProbE add-in will automatically create the required shared parameters to add the probability distributions to the building material thermal properties and bind them to each building material in the project. This application searches for the material names in the Excel database to assign the correct value to each parameter. This process begins with an attempt to open the external Excel database. Once the user starts this addin, a window will pop up asking the user to select an external Excel file. If the user selects an Excel file, the program will automatically start reading it cell by cell. The program will check the sanity of the data first and if there is no error found, it will continue with the rest of this process. The probability distributions (including the mean and standard deviation) for each material type are set according to the corresponding values in the Excel database. At the end of this process, BIMProbE allows writing the mean and standard deviation values of the thermal properties to a new Excel spreadsheet to be used for later steps of sampling and simulation.
Other design input parameters required for building energy simulations including Heating, Ventilation, and Air Conditioning (HVAC) system specifications, internal heat gain loads, infiltration and ventilation rates, and operational schedules are added using parametric tools such as Grasshopper, which is the visual programming environment for Rhinoceros.
Sampling and simulation
The information prepared in the pre-processing step is used for sample generation and iterative simulations. Using Latin Hypercube Sampling method, N samples for each design input variable are generated and N energy simulations are run for each design option (building forms) in Grasshopper. The simulation outputs (building annual heating and cooling loads) are recorded in Grasshopper and written to Excel using TT Toolbox plugin for Grasshopper [28]. For each round of the energy simulation, a corresponding value from the sample pool of each design variable (x_(uncer_i )) is selected and inserted into the simulation model, and as a result, N output values are obtained. The set of outputs whose elements correspond to the samples are Y={y_1,y_2,y_3,…,y_m },m=N, where Y denotes the space of output values, which are the results of building thermal load simulations.    
In the deterministic approach, all the design variables, regardless of being deterministic or uncertain, are assigned to their associated mean (µi) as a fixed value (xi = µi). Fixing all the input variables at their mean values, the energy simulation is run once and a single output y_det=f(µ_1,µ_2,µ_3,…,µ_n) is obtained, where (µ_1,µ_2,µ_3,…,µ_n) are the means of the design variables. 
Post-processing and design decision-making
The post-processing phase consists of data analysis and graphical presentation of the simulation results. This phase is conducted using a statistical software known as JMP. The data are collected in Grasshopper and exported to Excel for post-processing. The JMP [29] add-in for Excel provides interactive graphics and tables that enable the user to identify relationships visually and examine patterns. The histogram demonstrations, normality plots and box plots are used for risk assessment and data visualization.
The output results are represented by the values of deterministic and probabilistic outputs using two metrics of KPI and KRIs. In addition, design options are ranked according to the criteria of expected value, maximax, and maximin. The information provided in this process could help design decision-makers with building performance evaluation including uncertainties and comparing the probabilistic results with the deterministic results.
All the scripts are available in the links below:

https://github.com/Aban6/Grasshopper-sampling-Python
https://github.com/Aban6/BIMPro-CSharp
